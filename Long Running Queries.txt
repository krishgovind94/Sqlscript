SELECT
CAST(REQ.total_elapsed_time/(1000*60*60*24) AS varchar)+' Day '+CONVERT(varchar, DATEADD(ms, REQ.TOTAL_ELAPSED_TIME, 0),108) AS 'TOTAL_ELAPSED_TIME',
COMMAND,
REQ.SESSION_ID AS S_ID,
CAST((SELECT TEXT
FROM SYS.DM_EXEC_SQL_TEXT(SQL_HANDLE)
FOR XML RAW,ELEMENTS) AS XML) AS SQLTEXT_XML,
(SELECT TEXT
FROM SYS.DM_EXEC_SQL_TEXT(SQL_HANDLE)) AS SQLTEXT,
REQ.WAIT_TYPE,
REQ.BLOCKING_SESSION_ID,
DB_NAME(REQ.DATABASE_ID) AS DATABASE_NAME,
EX.original_login_name AS LOGIN_NAME,
REQ.WRITES,
REQ.READS,
REQ.STATUS,

CONVERT(TIME, DATEADD(ms, REQ.CPU_TIME, 0)) AS 'CPU_TIME',
CONVERT(TIME, DATEADD(ms, REQ.WAIT_TIME, 0)) AS 'WAIT_TIME',
REQ.START_TIME,
QP.QUERY_PLAN,

REQ.LOCK_TIMEOUT,
REQ.DEADLOCK_PRIORITY,

client_interface_name,
host_name
FROM
SYS.DM_EXEC_REQUESTS REQ
CROSS APPLY SYS.DM_EXEC_QUERY_PLAN(PLAN_HANDLE) AS QP
JOIN sys.dm_exec_sessions AS EX ON REQ.session_id=EX.session_id
WHERE REQ.SESSION_ID<>@@SPID
